<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventify - Registros de Auditoria</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css' %}">
    
    <style>
        /* Estilos específicos desta página de Logs (Tabela e Filtros) */
        .container-logs { max-width: 1000px; margin: 40px auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.05); }
        h2 { color: #333; margin-bottom: 20px; }
        
        /* Filtros */
        .filtros { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; display: flex; gap: 15px; align-items: flex-end; flex-wrap: wrap;}
        .campo-filtro { display: flex; flex-direction: column; }
        .campo-filtro label { font-size: 0.9em; margin-bottom: 5px; font-weight: bold; color: #555; }
        .campo-filtro input { padding: 10px; border: 1px solid #ddd; border-radius: 4px; outline: none; }
        
        button.btn-filtrar { padding: 10px 20px; background-color: #343a40; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; height: 38px; }
        button.btn-filtrar:hover { background-color: #23272b; }
        
        .link-limpar { color: #666; text-decoration: none; margin-bottom: 10px; font-size: 0.9em; }
        .link-limpar:hover { text-decoration: underline; }

        /* Tabela */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background-color: #f1e6b9; color: #333; padding: 15px; text-align: left; font-weight: bold; border-bottom: 2px solid #e0d090; }
        td { padding: 15px; border-bottom: 1px solid #eee; color: #555; }
        tr:hover { background-color: #fafafa; }
    </style>
</head>

<body>

  <header>
    <a href="index.html">
      <img src="{% static 'images/logo.png' %}" alt="Eventify Logo" class="logo">
    </a>

    <div class="menu-toggle" id="menu-toggle">
      ☰
    </div>

    <nav id="nav-menu">
      <a href="{% url 'eventos' %}">EVENTOS</a>
      <a href="{% url 'meuseventos' %}">MEUS EVENTOS</a>
      <a href="{% url 'certificados' %}">MEUS CERTIFICADOS</a>
      
      {% if usuario.perfil == 'organizador' %}
        <a href="{% url 'criar_evento' %}" style="background-color: #f8e08e;">CRIAR EVENTO</a>
      {% endif %}
      
      <a href="{% url 'perfil' %}">PERFIL</a>
      <a href="{% url 'logout' %}">SAIR</a>
    </nav>
  </header>

  <div class="container-logs">
    <h2>Registros de Auditoria</h2>

    <form method="GET" class="filtros">
        <div class="campo-filtro">
            <label>Data:</label>
            <input type="date" name="data" value="{{ request.GET.data }}">
        </div>

        <div class="campo-filtro">
            <label>Usuário:</label>
            <input type="text" name="usuario" placeholder="Nome ou Email..." value="{{ request.GET.usuario }}">
        </div>

        <button type="submit" class="btn-filtrar">Filtrar</button>
        <a href="{% url 'logs_auditoria' %}" class="link-limpar">Limpar</a>
    </form>

    <table>
        <thead>
            <tr>
                <th>Data/Hora</th>
                <th>Usuário</th>
                <th>Ação</th>
                <th>Detalhes</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>{{ log.data_hora|date:"d/m/Y H:i" }}</td>
                <td>
                    <strong>{{ log.usuario.nome }}</strong><br>
                    <small>{{ log.usuario.email }}</small>
                </td>
                <td>{{ log.acao }}</td>
                <td></td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center; padding: 30px;">
                    Nenhum registro encontrado com esses filtros.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
  </div>

</body>

<script>
  // Script para o menu responsivo funcionar também nesta página
  const menuToggle = document.getElementById('menu-toggle');
  const navMenu = document.getElementById('nav-menu');

  if (menuToggle) {
      menuToggle.addEventListener('click', () => {
        navMenu.classList.toggle('active');
      });
  }
</script>
</html>